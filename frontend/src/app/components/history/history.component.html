<h3>History</h3>
<p class="construction">Feature under construction</p>

<div class="row">
    <div>
        <b>Orders:</b> {{ stats?.orders ?? 0 }}
        <p-button label="Обновить" (onClick)="refreshOrders()" ></p-button>
        <p-button label="Export CSV" (onClick)="export('orders')"></p-button>
        <p-button label="Очистить" (onClick)="clear('orders')" severity="warning"></p-button>
    </div>
    <div>
        <b>Trades:</b> {{ stats?.trades ?? 0 }}
        <p-button label="Обновить" (onClick)="refreshTrades()"></p-button>
        <p-button label="Export CSV" (onClick)="export('trades')"></p-button>
        <p-button label="Очистить" (onClick)="clear('trades')" severity="warning"></p-button>
    </div>
    <div>
        <p-button label="Очистить всё" (onClick)="clear('all')" severity="primary"></p-button>
    </div>
</div>

<div class="two">
    <div>
        <h4>Orders (последние)</h4>
        <div *ngIf="loadingO">Загрузка...</div>
        <p-table *ngIf="!loadingO" [value]="orders" styleClass="tbl">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:60px;">ID</th>
                    <th style="width:140px;">TS</th>
                    <th style="width:80px;">Event</th>
                    <th style="width:100px;">Symbol</th>
                    <th style="width:60px;">Side</th>
                    <th style="width:80px;">Type</th>
                    <th style="width:80px;">Price</th>
                    <th style="width:80px;">Qty</th>
                    <th style="width:80px;">Status</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-o>
                <tr>
                    <td class="mono">{{o.id}}</td>
                    <td class="mono">{{o.ts*1000 | date:'medium'}}</td>
                    <td>{{o.event}}</td>
                    <td>{{o.symbol}}</td>
                    <td>{{o.side}}</td>
                    <td>{{o.type}}</td>
                    <td class="mono">{{o.price}}</td>
                    <td class="mono">{{o.qty}}</td>
                    <td>{{o.status}}</td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <div>
        <h4>Trades (последние)</h4>
        <div *ngIf="loadingT">Загрузка...</div>
        <p-table *ngIf="!loadingT" [value]="trades" styleClass="tbl">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:60px;">ID</th>
                    <th style="width:140px;">TS</th>
                    <th style="width:80px;">Type</th>
                    <th style="width:100px;">Symbol</th>
                    <th style="width:60px;">Side</th>
                    <th style="width:80px;">Price</th>
                    <th style="width:80px;">Qty</th>
                    <th style="width:80px;">PNL</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-t>
                <tr>
                    <td class="mono">{{t.id}}</td>
                    <td class="mono">{{t.ts*1000 | date:'medium'}}</td>
                    <td>{{t.type}}</td>
                    <td>{{t.symbol}}</td>
                    <td>{{t.side}}</td>
                    <td class="mono">{{t.price}}</td>
                    <td class="mono">{{t.qty}}</td>
                    <td class="mono" [class.pnl-positive]="(t.pnl||0) > 0" [class.pnl-negative]="(t.pnl||0) < 0">{{t.pnl}}</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
